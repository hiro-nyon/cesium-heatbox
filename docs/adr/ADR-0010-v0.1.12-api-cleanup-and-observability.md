# ADR-0010: v0.1.12 API Cleanup & Observability

English Summary / 英語サマリー

This ADR specifies API cleanup (naming unification, resolver deprecation, rendering mode consolidation) and new observability features (performance overlay, configuration profiles, benchmark improvements) for v0.1.12. The migration path preserves backward compatibility with warnings, introducing  + , /, and preset unification (). Phase 1–3 implement API changes, tests, and documentation, and Phase 4 validates quality (migration scenarios, performance smoke checks, browser compatibility, bilingual documentation consistency).

## Status
Proposed — 2025-09-09

## Context

### 現状と背景
v0.1.11でのリファクタリング・モジュール化完了により、内部構造が整理された。次のv0.1.12では、以下2つの課題に対処する時期に達している：

1. **APIの不統一と歴史的負債の解決**
   - オプション名の命名規則が統一されていない（例: `pitch` vs `pitchDegrees`）
   - 旧式のResolver系オプションが新しい適応制御システムと重複している
   - `outlineEmulation`等の古いオプションが新しいレンダリングモードと混在

2. **観測可能性（Observability）の不足**
   - パフォーマンス可視化が不十分でチューニングが困難
   - 設定の最適化ガイダンスが少ない
   - ベンチマークの結果が活用しにくい

### v0.1.11リファクタリング完了後の状況
- `src/core/`配下に専門クラスが分離済み:
  - `color/ColorCalculator.js` - 色計算専門
  - `selection/VoxelSelector.js` - ボクセル選択戦略専門  
  - `adaptive/AdaptiveController.js` - 適応制御専門
  - `geometry/GeometryRenderer.js` - ジオメトリ描画専門
- `VoxelRenderer.js`は300行以下のオーケストレーション役に特化

### APIクリーンアップが必要な項目
1. **オプション命名の不統一**:
   ```javascript
   // 現在の不統一例
   fitViewOptions: {
     pitch: -30,      // ← degreeが付いていない
     heading: 90      // ← degreeが付いていない
   }
   
   // その他のオプションでは
   pitchDegrees: -30,  // ← こちらはdegreesが付いている
   headingDegrees: 90
   ```

2. **旧式Resolver系の重複**:
   - `outlineWidthResolver`, `outlineOpacityResolver`, `boxOpacityResolver`
   - これらは新しい `adaptiveOutlines` + `adaptiveParams` + プリセットシステムと機能が重複

3. **レンダリングモードの混在**:
   - `outlineEmulation: true/false` 
   - 新しい `outlineRenderMode: 'standard'|'inset'|'emulation-only'` と統合すべき

### 観測可能性の課題
- 現在の `getStatistics()` は基本統計のみ
- フレーム時間やレンダリング性能の可視化機能がない
- ユースケース別の推奨設定が明文化されていない

## Decision

### 1. APIクリーンアップ（Breaking Changes含む）

#### 1.1 オプション命名の統一
```javascript
// BEFORE (削除予定)
fitViewOptions: {
  pitch: -30,      // degrees単位
  heading: 90      // degrees単位
}

// AFTER (統一) - 単位を明示的に名前に含める
fitViewOptions: {
  pitchDegrees: -30,    // 既定値: -45
  headingDegrees: 90    // 既定値: 0
}
```

**移行ルール**:
- 優先順位: 新名前 > 旧名前（両方存在時は新名前を採用し、一度だけ警告）
- 正規化処理順序: `validate` → `normalize` → `warnDeprecationOnce`
- 新API: `heatbox.getEffectiveOptions()` でデバッグ用の正規化後オプション取得が可能（インスタンスメソッドに統一）

#### 1.2 Resolver系オプションの削除と統合
```javascript
// BEFORE (削除予定)
{
  outlineWidthResolver: (voxel, info) => {...},
  outlineOpacityResolver: (voxel, info) => {...},
  boxOpacityResolver: (voxel, info) => {...}
}

// AFTER (既存システムに統合)
{
  outlineStrategy: 'preset',  // 'preset' | 'custom'
  outlineWidthPreset: 'adaptive',  // 'thin' | 'medium' | 'thick' | 'adaptive'
  adaptiveOutlines: true,
  adaptiveParams: {
    outlineWidthRange: [0.5, 3.0],    // 既定値: [0.8, 2.5]
    outlineOpacityRange: [0.3, 1.0],  // 既定値: [0.4, 0.9]
    boxOpacityRange: [0.1, 0.8]       // 既定値: [0.2, 0.7]
  }
}

// 高度なカスタマイズが必要な場合の拡張点
{
  outlineStrategy: 'custom',
  customOutlineStrategy: (voxelCtx) => ({
    width: /* custom logic */,
    opacity: /* custom logic */,
    boxOpacity: /* custom logic */
  })
}
```

**プリセット仕様**:
- `thin`: width=[0.5-1.2], opacity=[0.6-0.8]
- `medium`: width=[0.8-2.0], opacity=[0.4-0.9] 
- `thick`: width=[1.5-3.0], opacity=[0.3-1.0]
- `adaptive`: `adaptiveParams`の値を使用、密度ベースで動的調整

**レガシープリセット名の互換マッピング（警告付き）**:
- `uniform` → `medium`
- `adaptive-density` → `adaptive`
- `topn-focus` → `thick`

正規化時に上記へ置換し、`warnOnce` でデプリケーション警告を一度だけ表示する。

#### 1.3 レンダリングモードの統一（部分エミュレーションの互換維持）
```javascript
// BEFORE (削除予定)
{
  // 旧仕様は boolean だけでなく文字列も許容:
  // boolean | 'off' | 'topn' | 'non-topn' | 'all'
  outlineEmulation: 'topn'
}

// AFTER (統一) - 既定値: 'standard'
{
  outlineRenderMode: 'emulation-only',
  // 'standard' | 'inset' | 'emulation-only'
  // 互換のためエミュレーション対象を明示:
  emulationScope: 'all' // 'topn' | 'non-topn' | 'all'（v0.1.12で追加）
}
```

**移行マッピング**:
- boolean 互換:
  - `true` → `outlineRenderMode: 'emulation-only'`, `emulationScope: 'all'`
  - `false` → `outlineRenderMode: 'standard'`
- 文字列 互換:
  - `'off'` → `outlineRenderMode: 'standard'`
  - `'all'` → `outlineRenderMode: 'emulation-only'`, `emulationScope: 'all'`
  - `'topn'` → `outlineRenderMode: 'standard'`, `emulationScope: 'topn'`
  - `'non-topn'` → `outlineRenderMode: 'standard'`, `emulationScope: 'non-topn'`
- 未設定時の既定値: `'standard'`

**モード別特性**:
- `standard`: 通常品質、中程度レンダリングコスト
- `inset`: 高品質インセット描画、高レンダリングコスト
- `emulation-only`: 軽量エミュレーション、低レンダリングコスト

補足: `emulationScope` は `outlineRenderMode: 'standard'|'inset'` の場合でも有効で、標準/インセット描画に「部分的な太線エミュレーション」を重ね合わせる。`'emulation-only'` は標準/インセットを描かず、完全にエミュレーション描画に切り替える。将来的に（v1.0.0）`emulationScope` の扱いを見直す場合は本ADRの Migration にスケジュールを明示する。

### 2. 観測可能性・プロファイル機能の追加

#### 2.1 パフォーマンスオーバーレイ
**設定オプション**:
```javascript
// 生成時設定
const heatbox = new Heatbox(viewer, {
  performanceOverlay: true,  // または詳細設定
  // performanceOverlay: {
  //   position: 'top-right',           // 'top-left'|'top-right'|'bottom-left'|'bottom-right'
  //   fpsAveragingWindowMs: 1000,      // 既定値: 1000ms
  //   updateIntervalMs: 500            // 既定値: 500ms
  // }
});

// 実行時API
heatbox.setPerformanceOverlayEnabled(true);
```

**表示項目**:
- 描画ボクセル数 / 総ボクセル数 (更新: 500ms毎)
- TopN選択比率 (%) (更新: 500ms毎)
- 平均密度 (voxels/km²) (更新: 500ms毎)
- フレーム時間: `GeometryRenderer.draw()`計測開始〜終了 (平均: 1000ms窓)
- レンダリング戦略 (density/coverage/hybrid) (更新: 戦略変更時)

**パフォーマンス要件**:
- 計測オーバーヘッド: < 1ms/frame
- オーバーレイOFF時: ゼロコスト（lazy evaluation + guard）
- DOM要素: Shadow DOMまたは名前空間化CSSで描画干渉を回避

#### 2.2 設定プロファイル機能
```javascript
// 新機能: ユースケース別推奨設定
const heatbox = new Heatbox(viewer, {
  profile: 'mobile-fast'     // プリセット適用
});

// 設定適用順序: defaults <- profile <- userOptions (ユーザー設定が最優先)
```

**利用可能プロファイル**:
- `'mobile-fast'`: voxelBudget=5000, outlineRenderMode='emulation-only', adaptiveOutlines=false
- `'desktop-balanced'`: voxelBudget=15000, outlineRenderMode='standard', adaptiveOutlines=true
- `'dense-data'`: voxelBudget=25000, topNRatio=0.3, outlineWidthPreset='thin'
- `'sparse-data'`: voxelBudget=8000, topNRatio=0.8, outlineWidthPreset='thick'
- `'none'` または `undefined`: プロファイル適用なし

**追加API**:
```javascript
// プロファイル一覧取得
Heatbox.listProfiles(); // ['mobile-fast', 'desktop-balanced', ...]

// 有効設定の確認（デバッグ用）
heatbox.getEffectiveOptions(); // 正規化後の最終設定（インスタンスメソッド）
```

#### 2.3 ベンチマーク計測の整備
**`tools/benchmark.js`の改善**:
```bash
# 基本実行（既存）
npm run benchmark

# 新機能: 出力形式指定と比較
npm run benchmark -- --out csv --repeat 5 --warmup 2
npm run benchmark -- --out md --compare baseline.csv current.csv
```

**出力改善**:
- **環境情報**: OS、ブラウザ、GPU、commit hash、実行日時を含める
- **統計分析**: 平均・中央値・p95・標準偏差を算出（複数回実行時）
- **CSV固定カラム**: environment, dataset, profile, voxelCount, renderTimeMs, frameTimeMs, memoryMB
- **Markdown**: 統計サマリー + ダッシュボード形式の比較表

**再現性・比較性**:
- リピート回数とウォームアップ時間を設定可能
- `--compare base.csv target.csv`で差分比較（改善/悪化の%表示）
- ベンチマーク実行前の環境一貫性チェック（メモリ使用量、CPU負荷）

### 3. Migration Guide整備
- `MIGRATION.md`の新設
- 削除されたオプションから新オプションへの対応表
- コード例による移行手順の明示
 - レガシープリセット名・`outlineEmulation` 文字列の詳細マッピング表

## Consequences

### 利点
1. **API一貫性の向上**: 命名規則統一により開発体験が改善
2. **機能重複の解消**: Resolver系削除により保守性向上
3. **観測可能性の向上**: パフォーマンス監視とチューニングが容易に
4. **設定最適化支援**: プロファイル機能により適切な設定選択が可能
5. **ベンチマーク活用**: 性能比較と改善効果の可視化

### 破壊的変更のリスク
1. **既存コードの修正が必要**: オプション名変更により既存実装に影響
2. **学習コストの一時的増加**: 新しいオプション体系の理解が必要
3. **Resolver系依存コードの書き換え**: カスタマイズしていたユーザーへの影響

### リスク軽減策
1. **詳細なMigrationガイド**: コード例付きの移行手順書作成
2. **段階的廃止**: 一定期間の警告表示後に削除（`utils/deprecate.js`のwarnOnce使用）
3. **後方互換性の部分的維持**: 可能な限り古い名前での警告付き動作
4. **Wiki・READMEの同期更新**: 移行情報の明記
5. **拡張点の提供**: `customOutlineStrategy`等で高度なカスタマイズを継続可能
6. **オーバーレイ描画干渉の回避**: Shadow DOMまたは名前空間化CSSクラス使用
7. **ログスパム防止**: `warnOnce`とデバッグフラグで警告抑制
8. **部分エミュレーションの互換維持**: `emulationScope` で `'topn'|'non-topn'` を表現、段階的廃止は v1.0.0 に延期

## Implementation Plan

### フェーズ境界に関する補足（延期項目）
- Phase 1 では、ドキュメントの変更範囲を「コード上の定数更新」と「本ADRの更新」に限定します。
- README、JSDoc（型/typedef）、Examples の同期は、API移行期間中のドキュメント揺れを避けるため Phase 3 に明示的に先送りします。
- 型定義の整合は、MigrationガイドおよびWiki同期とあわせて Phase 3 で実施します。

### Development Workflow & Branch Strategy

#### Branch Structure
```
main (stable v0.1.11)
 └── next (integration branch)
     ├── feature/adr-0010-phase1-api-cleanup     # Phase 1 implementation
     ├── feature/adr-0010-phase2-observability   # Phase 2 implementation  
     ├── feature/adr-0010-phase3-documentation   # Phase 3 implementation
     └── feature/adr-0010-phase4-testing         # Phase 4 implementation
```

#### PR Workflow
1. **ブランチ作成**: 各Phase開始時に `next` から feature ブランチを作成
   ```bash
   git checkout next
   git pull origin next
   git checkout -b feature/adr-0010-phase1-api-cleanup
   ```

2. **Phase単位でのPR**: 各Phase完了時に `next` への PR を作成
   - PR タイトル: `[ADR-0010][Phase N] {brief description}`
   - 必須レビューイ: 1名以上
   - 必須チェック: lint, test, type-check の全パス

3. **統合とリリース**: 全Phase完了後
   ```bash
   # v0.1.12-alpha.1 としてタグ付け
   git tag v0.1.12-alpha.1
   # 安定性確認後、main へマージして v0.1.12 リリース
   ```

#### Quality Gates per Phase
各Phase PR作成前に以下を確認：
- [ ] `npm run lint` パス（エラー0）
- [ ] `npm test` パス（既存テスト100%）  
- [ ] `npm run type-check` パス
- [ ] examples/basic, examples/advanced の動作確認（注: Phase 1 ではAPI移行の影響最小化のためドキュメント/Examplesの同期は行わず、Phase 3で一括対応）
- [ ] 後方互換性テスト（該当する場合）

### Phase 1: APIクリーンアップ実装（Week 1-2）
- [x] オプション命名統一の実装
  - [x] `fitViewOptions.pitch/heading` → `pitchDegrees/headingDegrees`
  - [x] 新名前優先、旧名前は警告表示で対応
- [x] Resolver系削除の実装
  - [x] `adaptiveParams`システムとの統合（旧Resolverは正規化で除去し警告）
  - [x] 削除予定オプションの警告表示（warnOnce, Logger.warn）
- [x] `outlineRenderMode`統一の実装
  - [x] `outlineEmulation`（boolean/文字列）からの移行ロジック
  - [x] `emulationScope` 追加と互換マッピング
 - [x] プリセット名の統一
  - [x] レガシー名（`uniform`/`adaptive-density`/`topn-focus`）のマッピングと警告
 - [ ] 定数/型/JSDoc/Examplesの同期更新（定数は更新済。型/JSDoc/ExamplesはPhase 3で対応）

### Phase 2: 観測可能性機能追加（Week 2-3）
- [x] パフォーマンスオーバーレイUI作成
  - [x] リアルタイム統計表示
  - [x] ON/OFF切り替え機能
  - [x] `examples/advanced/`への統合
- [x] プロファイル機能実装
  - [x] プリセット定義と適用ロジック
  - [x] `validateAndNormalizeOptions`でのマージ処理
  - [x] `Heatbox.listProfiles()`（静的）/ `heatbox.getEffectiveOptions()`（インスタンス）APIの実装
- [x] ベンチマーク改善
  - [x] `tools/benchmark.js`の出力形式改善
  - [x] 統計分析機能追加

### Phase 3: ドキュメント・移行支援（Week 3-4）
- [x] `MIGRATION.md`作成
  - [x] オプション対応表作成（旧→新マッピング辞書）
  - [x] コード例による移行手順（双方向例を含む）
  - [x] よくある移行パターンと落とし穴
- [x] Phase 1 で延期した同期作業の一括実施（明示）
  - [x] README の更新（新API、`emulationScope`、プリセット新名、`getEffectiveOptions` 反映）
  - [x] JSDoc の再生成（docs/api）
  - [x] Examples（basic/advanced）の新API対応（`pitchDegrees/headingDegrees`、新プリセット、`emulationScope` の使用例）
- [x] 型定義更新
  - [x] JSDocの`@typedef`で新オプション定義（`emulationScope`、`outlineRenderMode`、`ProfileName`等）
  - [x] `outlineRenderMode`/`outlineWidthPreset(thin|medium|thick|adaptive)` の文字列リテラル型提供
  - [x] プロファイル名とオーバーレイ設定の型安全性確保
- [x] README・Wiki同期更新
  - [x] `tools/wiki-sync.js`の対象ページリストに`MIGRATION.md`追加
  - [x] API参照の新オプション反映
- [x] examples更新（新API対応）
  - [x] `examples/advanced/`にパフォーマンスオーバーレイ有効化サンプル追加
  - [x] `examples/advanced/v0.1.12-features-demo.html` 新機能総合デモ追加

### Phase 4: テスト・品質保証（Week 4）
- [x] 移行シナリオのテスト
  - [x] v0.1.11→v0.1.12移行パスの包括的テストスイート作成
  - [x] 後方互換性と警告メカニズムの検証
  - [x] プロファイル機能とパフォーマンスオーバーレイ統合テスト
- [x] パフォーマンス劣化チェック
  - [x] プロファイル別性能ベンチマーク（全4プロファイル）
  - [x] 適応制御オーバーヘッド測定（50%以内達成）
  - [x] メモリ使用量回帰テスト（50MB以内達成）
- [x] ブラウザ互換性テスト
  - [x] 主要ブラウザ対応確認（Chrome 90+, Firefox 88+, Safari 14+, Edge 90+）
  - [x] ブラウザ互換性チェッカー作成とテストページ生成
  - [x] WebGL要件とES6機能の互換性検証
- [x] ドキュメント整合性確認
  - [x] API用語の網羅性確認（95%カバレッジ達成）
  - [x] README/MIGRATION/Examples間の整合性検証
  - [x] ドキュメント整合性チェッカー作成
- [x] v0.1.12で作成/更新したドキュメントのバイリンガル整合確認（日本語/English）
  - [x] README（日英併記の維持）
  - [x] MIGRATION.md（新規作成・日英対応完了）
  - [x] examples/advanced（v0.1.12-features-demo.htmlで日英対応）
  - [x] Wiki（JSDoc→Markdown変換で日英セクション整備）
- [x] 品質保証レポート作成
  - [x] QUALITY_ASSURANCE_REPORT.md作成
  - [x] 全Phase 4項目の完了確認とスコアリング

## Acceptance Criteria

### 機能要件
- [ ] 新しいオプション体系での完全動作
- [ ] 古いオプション使用時の適切な警告表示
- [ ] パフォーマンスオーバーレイの正常動作（描画数・フレーム時間の相関表示）
- [ ] 4種類のプロファイルが一貫した設定セットを適用
- [ ] ベンチマーク結果の再現可能性と比較容易性

### 品質要件
- [x] 既存テスト100%パス（移行ロジック含む）
- [x] Lint errors 0
- [ ] パフォーマンス影響±5%以内（median frame time on examples/advanced dense dataset, overlay OFF基準）
- [ ] `MIGRATION.md`に全変更項目の記載完了
- [ ] デプリケーション警告文言は英語で統一
- [ ] 4種類のプロファイルが一貫した設定適用（スナップショットテストまたは設定ハッシュ比較で検証）

### ドキュメント要件
- [ ] README・API・Wikiの新オプション対応完了
- [ ] 移行ガイドの実用性確認（外部レビュー）
- [ ] examples/basic、examples/advancedの新API動作確認

## Migration Strategy

### 段階的廃止スケジュール
1. **v0.1.12**: 新オプション追加、旧オプションは警告付きで動作（非破壊）
2. **v0.1.13**: 旧オプションの警告強化（起動時に一度＋該当メソッド使用時）
3. **v1.0.0**: 旧オプション完全削除（`outlineEmulation` とレガシープリセット名、`emulationScope` の扱いも見直し）

### 後方互換性の維持範囲
```javascript
// v0.1.12での対応例（utils/deprecate.js使用）
import { warnOnce } from './utils/deprecate.js';

function normalizeOptions(options = {}) {
  // 旧名前の検出と警告（一度だけ）
  if (options.fitViewOptions?.pitch !== undefined) {
    warnOnce('fitViewOptions.pitch',
      '[Heatbox][DEPRECATION][v1.0.0] fitViewOptions.pitch is deprecated; use fitViewOptions.pitchDegrees.');
    options.fitViewOptions.pitchDegrees = options.fitViewOptions.pitchDegrees ?? options.fitViewOptions.pitch;
  }
  if (options.fitViewOptions?.heading !== undefined) {
    warnOnce('fitViewOptions.heading',
      '[Heatbox][DEPRECATION][v1.0.0] fitViewOptions.heading is deprecated; use fitViewOptions.headingDegrees.');
    options.fitViewOptions.headingDegrees = options.fitViewOptions.headingDegrees ?? options.fitViewOptions.heading;
  }

  // outlineEmulation（boolean/文字列）の移行
  if (options.outlineEmulation !== undefined && options.outlineRenderMode === undefined) {
    warnOnce('outlineEmulation',
      '[Heatbox][DEPRECATION][v1.0.0] outlineEmulation is deprecated; use outlineRenderMode/emulationScope instead.');
    const v = options.outlineEmulation;
    if (v === false || v === 'off') {
      options.outlineRenderMode = 'standard';
    } else if (v === true || v === 'all') {
      options.outlineRenderMode = 'emulation-only';
      options.emulationScope = options.emulationScope ?? 'all';
    } else if (v === 'topn' || v === 'non-topn') {
      options.outlineRenderMode = 'emulation-only';
      options.emulationScope = options.emulationScope ?? v;
    } else {
      options.outlineRenderMode = 'standard';
    }
  }

  // レガシープリセット名の置換
  const preset = options.outlineWidthPreset;
  if (preset === 'uniform' || preset === 'adaptive-density' || preset === 'topn-focus') {
    const map = { 'uniform': 'medium', 'adaptive-density': 'adaptive', 'topn-focus': 'thick' };
    warnOnce(`outlineWidthPreset.${preset}`,
      `[Heatbox][DEPRECATION][v1.0.0] outlineWidthPreset "${preset}" is deprecated; use "${map[preset]}".`);
    options.outlineWidthPreset = map[preset];
  }

  return options;
}
```

**警告メッセージ規約**:
- 英語・固定フォーマット: `[Heatbox][DEPRECATION][削除版] 旧名 is deprecated; use 新名.`
- 一度だけ警告: `utils/deprecate.js`の`warnOnce(code, message)`ヘルパー使用
- 代替案と削除予定バージョンを明記
- ロガーは `Logger.warn` を内部使用（`warnOnce` がラップ）

## Testing Strategy

### 移行テストケース
- [ ] 旧オプション使用時の警告表示確認（1回のみ、重複なし）
- [ ] 新旧オプション混在時の優先順位確認（新 > 旧）
- [ ] プロファイル適用の一貫性確認（適用順序: defaults <- profile <- user）
- [ ] パフォーマンスオーバーレイの表示精度確認
- [ ] `outlineRenderMode`移行マッピングの正確性確認
 - [ ] `emulationScope` による `topn/non-topn` の互換動作確認
 - [ ] レガシープリセット名→新名の置換と警告確認

### パフォーマンステスト
- [ ] オーバーレイON/OFF時の性能影響測定（< 1ms/frame制約）
- [ ] プロファイル適用前後の性能比較
- [ ] 大規模データでの統計表示負荷測定
- [ ] DOM要素干渉テスト（Shadow DOM/CSS名前空間）

### 追加テストケース
- [ ] **プロファイルテスト**: 適用順序、個別上書き、境界値（レンジ外→クランプ）
- [ ] **オーバーレイテスト**: ON/OFFでのオーバーヘッド測定とDOM生成/破棄
- [ ] **ベンチマークテスト**: 同一入力での再現誤差範囲（連続3回の分散が5%以下）
- [ ] **デプリケーションテスト**: `warnOnce`の重複防止と適切なメッセージ出力

## References
- [ROADMAP.md v0.1.12 section](../../../ROADMAP.md#v0112apiクリーンアップ観測可能性)
- ADR-0009: VoxelRenderer責任分離（実装基盤）
- [Semantic Versioning](https://semver.org/)
- [API Evolution Best Practices](https://www.troyhunt.com/your-api-versioning-is-wrong-which-is/)

## 先行実装のTODOプレースホルダ（低コスト価値大）

### 即座に追加可能な枠組み
1. **`MIGRATION.md`雛形**:
   ```markdown
   # Migration Guide v0.1.11 → v0.1.12
   
   ## Option Name Changes
   | v0.1.11 (Deprecated) | v0.1.12 (New) | Notes |
   |---------------------|----------------|-------|
   | `fitViewOptions.pitch` | `fitViewOptions.pitchDegrees` | Unit clarification |
   
   ## Code Examples
   <!-- TODO: Add before/after examples -->
   ```

2. **`utils/deprecate.js`枠組み**:
   ```javascript
   import Logger from './logger.js';
   const warnedCodes = new Set();
   export function warnOnce(code, message) {
     if (!warnedCodes.has(code)) {
       Logger.warn(message);
       warnedCodes.add(code);
     }
   }
   ```

3. **`tools/benchmark.js`引数パース枠**:
   ```javascript
   // TODO: Add --out csv|md, --compare, --repeat, --warmup flags
   const args = process.argv.slice(2);
   const outFormat = args.includes('--out') ? args[args.indexOf('--out') + 1] : 'console';
   ```

4. **`examples/advanced/`パフォーマンスオーバーレイ設定**:
   ```javascript
   // TODO: Enable in branch-specific config
   // performanceOverlay: { position: 'top-right', fpsAveragingWindowMs: 1000 }
   ```
