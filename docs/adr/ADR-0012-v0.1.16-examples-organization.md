# ADR-0012: v0.1.16 Examples 体系化・整理

## Status
Proposed — 2025-11-01

## Context
- ROADMAP v0.1.16 は examples/ 配下を体系化し、学習・検証導線を改善することを目的とする。
- 現状（確認済み）
  - 既存の高度な例は `examples/advanced/` に集約されており、多数のデモが実装済み。
    - 適応レンダリング: `adaptive-rendering-demo.html/.js`, `adaptive-phase3-demo.html`
    - 枠線/描画: `wireframe-height-demo-umd.html/.js`, `outline-overlap-demo-umd.html`
    - 観測可能性/性能: `performance-overlay-demo.html`, `performance-optimization.js`
    - データ処理: `entity-filtering.js`
    - v0.1.12 機能まとめ: `v0.1.12-features-demo.html`
  - `examples/basic/` はシンプルなUI例があるが、カテゴリ分割・README 整備は未実施。
- ROADMAP の受け入れ基準では、カテゴリ分割（observability/rendering/outlines/selection-limits/data）、各カテゴリ README、テンプレート統一、そして新規デモ（emulation-scope-demo、selection-strategy-demo）の追加が必要。

## Decision
- examples/ 配下を以下のカテゴリへ整理する（段階移行）。
  - observability/（観測可能性・オーバーレイ・メトリクス）
  - rendering/（描画モード・高さ・ワイヤーフレーム等）
  - outlines/（標準/インセット/エミュレーションの比較）
  - selection-limits/（選択戦略と描画上限・自動レンダリング上限）
  - data/（データ生成・フィルタリング）
- 既存デモを上記カテゴリへマッピングする（初期はリンク整理・README 整備のみで git mv は第3段階）。
  - observability: `performance-overlay-demo.html`, `performance-optimization.js`
  - rendering: `wireframe-height-demo-umd.html/.js`, `v0.1.12-features-demo.html`
  - outlines: `outline-overlap-demo-umd.html`（＋新規: emulation-scope-demo.html）
  - selection-limits: `adaptive-rendering-demo.html/.js`（＋新規: selection-strategy-demo.html/.js）
  - data: `entity-filtering.js`
- HTML テンプレート（Cesium CSS/JS, UMD/ESM切替コメント）を統一し、各カテゴリに README を追加する。
- 例名・ファイル名はケバブケース、UIテキストは英語、README は日英併記の方針とする。

### Cesium 設定方針（黒画面回避）と gh-pages 参照
- 既定（デモ/ローカルとも）: Ion に依存しない初期化を標準とする。
  - `Cesium.Ion.defaultAccessToken = null` を明示。
  - 背景は `UrlTemplateImageryProvider`（例: OSM / CartoDB Light）。
  - 地形は `EllipsoidTerrainProvider` を既定（`createWorldTerrain` は使用しない）。
- gh-pages のプレイグラウンド実装を準拠例とする（public）：
  - `playground/index.html` の設定（CDN版Cesium、`CESIUM_BASE_URL`、Ion無効化）
  - `playground/app.js` の `UrlTemplateImageryProvider` 採用と `EllipsoidTerrainProvider` フォールバック
- Ion を使う例が必要な場合（任意）:
  - 冒頭で `Cesium.Ion.defaultAccessToken = '<PUBLIC_TOKEN>'` を設定し、`createWorldTerrain()`/`IonImageryProvider` を選択可能にする。
  - `<PUBLIC_TOKEN>` は gh-pages 側で公開しているトークンを流用可（公開前提）。未設定時は必ず OSM/エリプソイドにフォールバック。
- 既存の examples/advanced 内の `Cesium.createWorldTerrain()` 呼び出しは、v0.1.16 で上記方針に沿って置換/フォールバックを適用（黒画面にならないことを受け入れ基準に含める）。

## Consequences
- ドキュメント/学習導線が改善され、v0.1.12〜v0.1.15 で導入した API/オプションを再現可能な形で提示できる。
- 既存ファイルの物理移動（git mv）は後段で行うため、短期のリンク切れリスクを回避できる。
- 小規模の新規デモ（emulation-scope-demo、selection-strategy-demo）の追加コストが発生する。

## Implementation Plan
- Phase 1（Step 1: README/リンク整備）
  - `examples/advanced/README.md` を拡充し、上記カテゴリの見出しと既存デモへのリンク表を追加。
  - 共通 HTML テンプレートのスニペットを tools/wiki-sync.js にも共有（既存方針に追随）。
- Phase 2（新規デモの追加）
  - outlines: `emulation-scope-demo.html`（`outlineRenderMode` と `emulationScope` の組合せ比較）
  - selection-limits: `selection-strategy-demo.html/.js`（density/coverage/hybrid をサイドバイサイド比較）
- Phase 3（ディレクトリ移行）
  - 影響範囲を確認しつつ、カテゴリ配下へ `git mv`。リンク更新と最小の差分での移行を実施。
- Phase 4（Wiki 同期）
  - `tools/wiki-sync.js` を用い、Examples ページを同期。

## Acceptance Criteria（ROADMAP 反映）
- `observability/rendering/outlines/selection-limits/data` の5カテゴリが存在する（少なくとも README + 既存デモのリンク）。
- すべてのHTML例で白/黒画面にならず、コンソールエラーが無い（ローカル確認）。
- v0.1.12 の新APIが少なくとも1つの例で確認可能（outlineRenderMode/emulationScope、pitchDegrees/headingDegrees、profile）。
- 新規デモ2件が追加され、選択戦略とエミュレーション適用範囲の比較ができる。

## Risks & Mitigations
- URL/リンク切れ: Step 1でリンクのみ先行整備、物理移動は Step 3 に一括。
- テンプレート差異による回帰: 共通テンプレート化・差分最小化で軽減。
